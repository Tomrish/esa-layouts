(()=>{"use strict";var e,t={8104:(e,t,i)=>{var o=i(5803),r=i(5925);function n(e){return(0,r.yh)((function(t,i){t.computed=t.computed||{},t.computed[i]={cache:!1,get:function(){return this.$refs[e||i]}}}))}i(4807),i(7023),i(5654),i(779),i(8793);var a=i(8586),l=d("computed",a.rn),s=(d("computed",a.Se),d("methods",a.nv),d("methods",a.OI));function d(e,t){function i(i,o){return(0,r.yh)((function(r,n){r[e]||(r[e]={});var a,l=((a={})[n]=i,a);r[e][n]=void 0!==o?t(o,l)[n]:t(l)[n]}))}return function(e,t){if("string"==typeof t){var o=t,r=e;return i(o,void 0)(r,o)}return i(e,function(e){var t=e&&e.namespace;if("string"==typeof t)return"/"!==t[t.length-1]?t+"/":t}(t))}}var u=i(8138),c=i.n(u),p=function(e,t,i,o){var r,n=arguments.length,a=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,o);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(n<3?r(a):n>3?r(t,i,a):r(t,i))||a);return n>3&&a&&Object.defineProperty(t,i,a),a},v=function(e,t,i,o){return new(i||(i=Promise))((function(r,n){function a(e){try{s(o.next(e))}catch(e){n(e)}}function l(e){try{s(o.throw(e))}catch(e){n(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,l)}s((o=o.apply(e,t||[])).next())}))};let y=class extends o.default{constructor(){super(...arguments),this.playlist=[],this.video=null,this.index=0}playNextVideo(){return v(this,void 0,void 0,(function*(){const e=this.videos.find((e=>e.sum===this.playlist[this.index]));e?(this.video=e,this.playerSrc.src=e.url,this.playerSrc.type=`video/${e.ext.toLowerCase().replace(".","")}`,this.player.load(),this.player.play(),this.updateCurrent(e.sum)):(this.index+=1,this.playNextVideo())}))}videoEnded(){this.video&&this.updatePlayCount(this.video.sum),this.playlist.length-1>this.index?(this.index+=1,this.playNextVideo()):(this.clearPlaylist(),nodecg.sendMessage("videoPlayerFinished"))}stopVideo(){this.updateCurrent(),this.video=null,this.player.pause(),this.playerSrc.removeAttribute("src"),this.playerSrc.removeAttribute("type"),this.player.load()}startPlaylist(){return v(this,void 0,void 0,(function*(){this.videoPlayer.playlist.length?(this.index=0,this.playlist=c()(this.videoPlayer.playlist),this.playNextVideo()):(yield new Promise((e=>window.setTimeout(e,2e3))),nodecg.sendMessage("videoPlayerFinished"))}))}stopPlaylist(){this.index=0,this.playlist.length=0}mounted(){const e=window.obsstudio;e&&(e.onActiveChange=e=>{e?this.startPlaylist():(this.stopVideo(),this.stopPlaylist())}),this.player.addEventListener("ended",this.videoEnded)}};p([l],y.prototype,"videos",void 0),p([l],y.prototype,"videoPlayer",void 0),p([s],y.prototype,"updatePlayCount",void 0),p([s],y.prototype,"updateCurrent",void 0),p([s],y.prototype,"clearPlaylist",void 0),p([n("VideoPlayer")],y.prototype,"player",void 0),p([n("VideoPlayerSrc")],y.prototype,"playerSrc",void 0),y=p([r.ZP],y);const h=y,f=(0,i(5440).Z)(h,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("video",{directives:[{name:"show",rawName:"v-show",value:e.video,expression:"video"}],ref:"VideoPlayer",style:{display:"block",width:"100vw",height:"100vh"}},[i("source",{ref:"VideoPlayerSrc"})])}),[],!1,null,null,null).exports;o.default.use(a.ZP);const P={videoPlayer:nodecg.Replicant("videoPlayer"),videos:nodecg.Replicant("assets:videos")},m=new a.ZP.Store({state:{},mutations:{setState(e,{name:t,val:i}){o.default.set(e,t,i)},updateCurrent(e,t){void 0!==P.videoPlayer.value&&(P.videoPlayer.value.current=t||null)},updatePlayCount(e,t){void 0!==P.videoPlayer.value&&t&&(P.videoPlayer.value.plays[t]?P.videoPlayer.value.plays[t]+=1:P.videoPlayer.value.plays[t]=1)},clearPlaylist(){void 0!==P.videoPlayer.value&&(P.videoPlayer.value.playlist.length=0)}}});var g,w,x,b;Object.keys(P).forEach((e=>{P[e].on("change",(t=>{m.commit("setState",{name:e,val:c()(t)})}))})),(g=void 0,w=void 0,x=void 0,b=function*(){return yield NodeCG.waitForReplicants(...Object.keys(P).map((e=>P[e]))),m},new(x||(x=Promise))((function(e,t){function i(e){try{r(b.next(e))}catch(e){t(e)}}function o(e){try{r(b.throw(e))}catch(e){t(e)}}function r(t){var r;t.done?e(t.value):(r=t.value,r instanceof x?r:new x((function(e){e(r)}))).then(i,o)}r((b=b.apply(g,w||[])).next())}))).then((e=>{new o.default({store:e,el:"#App",render:e=>e(f)})}))},779:(e,t,i)=>{"undefined"!=typeof Reflect&&Reflect.getMetadata}},i={};function o(e){var r=i[e];if(void 0!==r)return r.exports;var n=i[e]={exports:{}};return t[e](n,n.exports,o),n.exports}o.m=t,e=[],o.O=(t,i,r,n)=>{if(!i){var a=1/0;for(d=0;d<e.length;d++){for(var[i,r,n]=e[d],l=!0,s=0;s<i.length;s++)(!1&n||a>=n)&&Object.keys(o.O).every((e=>o.O[e](i[s])))?i.splice(s--,1):(l=!1,n<a&&(a=n));l&&(e.splice(d--,1),t=r())}return t}n=n||0;for(var d=e.length;d>0&&e[d-1][2]>n;d--)e[d]=e[d-1];e[d]=[i,r,n]},o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var i in t)o.o(t,i)&&!o.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={516:0};o.O.j=t=>0===e[t];var t=(t,i)=>{var r,n,[a,l,s]=i,d=0;for(r in l)o.o(l,r)&&(o.m[r]=l[r]);for(s&&s(o),t&&t(i);d<a.length;d++)n=a[d],o.o(e,n)&&e[n]&&e[n][0](),e[a[d]]=0;o.O()},i=self.webpackChunk=self.webpackChunk||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})();var r=o.O(void 0,[947,539],(()=>o(8104)));r=o.O(r)})();